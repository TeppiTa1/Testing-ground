
---
# Cambridge IGCSE & A-Level Question Bank Toolkit

This project is a powerful toolkit designed to process Cambridge exam question paper PDFs, automatically categorize individual questions by topic using the Google Gemini AI, and allow users to build custom mock exam papers from the sorted question bank.

This project was built upon an initial question extraction script generously provided by **Joshbuild10**. The core logic for identifying question boundaries in the original PDFs is based on their foundational work.

## Key Features

-   **Automated PDF Splitting:** Extracts individual questions from full question paper PDFs.
-   **AI-Powered Topic Sorting:** Uses the Google Gemini API to analyze each question's text and sort it into relevant topic folders based on official syllabi.
-   **Hierarchical Organization:** Automatically creates a clean, structured folder system: `Subject > Paper > Question Files`.
-   **Interactive Mock Paper Builder:** A command-line tool to browse the sorted question bank and assemble custom mock exams for specific topics.

---

## Folder Structure

The project uses the following folder structure. You will need to create the `papers` and `syllabi` directories yourself.

```
.
├── papers/                  # <-- PLACE your source PDF question papers here
│   ├── 0620_s23_qp_41.pdf
│   └── 9701_w23_qp_22.pdf
│
├── syllabi/                 # <-- PLACE your syllabus .txt files here
│   └── 0620/
│   │   └── 0620_2025-2026_syllabus.txt
│   └── 9701/
│       └── 9701_2024-2025_syllabus.txt
│
├── extracted_questions/     # <-- GENERATED by splitter.py
│   └── 0620/
│       └── 0620_s23_qp_41/
│           ├── Q1.pdf
│           └── Q2.pdf
│
├── sorted_questions_by_topic/ # <-- GENERATED by sorting.py
│   └── 0620/
│       └── topic_1_the_particulate_nature_of_matter/
│           ├── 0620_s23_qp_41_Q1.pdf
│           └── 0620_s23_qp_42_Q1.pdf
│
├── Mock_paper_0620_1.pdf    # <-- GENERATED by MockBuilder.py
│
├── splitter.py              # The script to extract questions from PDFs
├── sorting.py               # The script to sort questions using AI
├── MockBuilder.py           # The script to build mock papers
└── script.py                # The main control panel to run the workflow
```

---

## Setup and Installation

Follow these steps to get the project running.

### 1. Dependencies

This project requires Python 3.8 or higher. First, install the necessary Python libraries. It's recommended to create a `requirements.txt` file with the following content:

**`requirements.txt`**
```
pymupdf
google-generativeai```

Then, install them using pip:
```bash
pip install -r requirements.txt
```

### 2. Google Gemini API Key

The AI sorting script requires an API key from Google AI Studio.

1.  Visit [Google AI Studio](https://aistudio.google.com/) and create an API key.
2.  **Set the API Key as an Environment Variable.** This is the most secure way to handle your key. **Do not paste it directly into the code.**

    -   **On Windows (Command Prompt):**
        ```bash
        set GOOGLE_API_KEY="YOUR_API_KEY_HERE"
        ```

    -   **On macOS / Linux (Terminal):**
        ```bash
        export GOOGLE_API_KEY="YOUR_API_KEY_HERE"
        ```
    *Note: You must run this command in the same terminal session you use to run the Python script.*

### 3. Prepare Source Files

1.  **Papers:** Create a folder named `papers` in the project root and place your PDF question papers inside.
2.  **Syllabi:** Create a folder named `syllabi`. Inside it, create a subfolder for each subject code (e.g., `0620`). Inside the subject folder, place a `.txt` file containing the syllabus content. The AI sorter will look for a filename ending in `_syllabus.txt`.

---

## Usage Workflow

The entire process is controlled by the `script.py` file. It will guide you through the three main stages of the workflow.

Run the script from your terminal:
```bash
python script.py
```

You will be prompted with a series of questions:

1.  **Extract Questions (Splitter):** The script will first ask if you want to process the PDFs in the `papers` folder. This runs `splitter.py` to extract individual questions into the `extracted_questions` directory.

2.  **Sort Questions (AI Sorter):** Next, it will ask if you want to sort the extracted questions. This runs `sorting.py`, which communicates with the Gemini API. **This step can take a long time and will make many API calls.** It populates the `sorted_questions_by_topic` directory.

3.  **Build a Mock Paper (Mock Builder):** Finally, it will ask if you want to build a mock paper. This runs `MockBuilder.py`, an interactive tool that lets you choose a subject, a topic, and then select questions to be combined into a final PDF.

---

## How It Works

### `splitter.py`
This script crawls the `papers` directory, opens each PDF, and uses advanced text and coordinate analysis to identify the boundaries of each question. It then creates a new, separate PDF for each question and saves it in a structured folder within `extracted_questions`.

### `sorting.py`
This is the AI-powered core. It works by:
1.  Crawling the `extracted_questions` directory.
2.  For each question file, it extracts the subject code from the path and finds the corresponding syllabus file in the `syllabi` folder.
3.  It extracts the text from the question PDF.
4.  It constructs a detailed prompt containing the syllabus context and the question text, asking the Gemini API to classify the question by its major topic.
5.  It parses the AI's response and copies the question PDF into the appropriate topic folder(s) inside `sorted_questions_by_topic`.

### `MockBuilder.py`
This is an interactive command-line interface (CLI) that:
1.  Scans the `sorted_questions_by_topic` directory to find available subjects and topics.
2.  Presents the user with a numbered list to choose a subject.
3.  Presents a numbered list to choose a topic within that subject.
4.  Allows the user to select multiple questions from the chosen topic in a loop.
5.  Finally, it merges all the selected question PDFs into a single, clean file named `Mock_paper_<subject_code>_1.pdf`.